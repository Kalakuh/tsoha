{% extends "layout.html" %}

{% block body %}
<p>
	<h2 class="display-4">Haku</h2>
	<form method="POST" action="{{ url_for('search') }}">
		<div class="form-group">
			<label>{{ form.contains.label }}</label>
			{{ form.contains(class_="form-control", placeholder="Sisältää") }}
			<ul>
				{% for error in form.contains.errors %}
					<li>{{ error }}</li>
				{% endfor %}
			</ul>
		</div>
		<div class="form-group">
			<label>{{ form.name.label }}</label>
			{{ form.name(class_="form-control", placeholder="Nimi") }}
			<ul>
				{% for error in form.name.errors %}
					<li>{{ error }}</li>
				{% endfor %}
			</ul>
		</div>
		<div class="form-group">
			<label>{{ form.after_date.label }}</label>
			{{ form.after_date(class_="form-control", placeholder="pp.kk.yyyy") }}
			<ul>
				{% for error in form.after_date.errors %}
					<li>{{ error }}</li>
				{% endfor %}
			</ul>
		</div>
		<div class="form-group">
			<label>{{ form.before_date.label }}</label>
			{{ form.before_date(class_="form-control", placeholder="pp.kk.yyyy") }}
			<ul>
				{% for error in form.before_date.errors %}
					<li>{{ error }}</li>
				{% endfor %}
			</ul>
		</div>
		<div class="form-group">
			<label>Kuuluu kategorioihin</label>
			{% for category in categories %}
				<div class="form-check">
					<input class="form-check-input" type="checkbox" value="true" name="category{{ category.id }}">
					<label class="form-check-label">
						<span class="badge badge-secondary">{{ category.name }}</span>
					</label>
				</div>
			{% endfor %}
		</div>
		<input class="btn btn-primary btn-small" type="submit" value="Hae viestejä">
	</form>
	
	<hr>

	{% if results|length > 0 %}
		{% for thread in results %}
			<div class="container">
				<h2 class="display-4"><a href="{{ url_for('get_thread', thread_id = thread.id )}}">{{ thread.topic }}</a></h2>
				{% for category in thread.categories %}
					<span class="badge badge-secondary">{{ category.name }}</span> 
				{% endfor %}
				</p>
				Kirjoittaja: {{ thread.sender.first_name }} {{ thread.sender.surname }}<br>
				Kirjoitettu: {{ thread.posted }}<br>
				{% if thread.deletable %}
					</p>
					<a href="{{ url_for('delete_thread', thread_id = thread.id) }}">
						<button type="button" class="btn btn-danger btn-sm">Poista</button>
					</a>
				{% endif %}
			</div>
			<hr class="my-4">
		{% endfor %}
	{% else %}
		<h2 class="display-4">Ei tuloksia.</h2>
	{% endif %}
</p>
{% endblock %}